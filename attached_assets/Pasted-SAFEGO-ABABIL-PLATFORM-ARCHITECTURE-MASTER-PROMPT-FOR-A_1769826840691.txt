SAFEGO / ABABIL PLATFORM — ARCHITECTURE MASTER PROMPT (FOR ANY AGENT)
Language: Bangla explanations. Code/commands/filenames: English only.
Tone: Proof-first. Non-breaking. No refactors. Minimal diffs. One task at a time.

0) HARD RULES (MANDATORY)
0.1 Existing working CI foundation is READ-ONLY. Do not refactor it.
0.2 No “done/ok/fixed” claims without proof: git diff, git status, workflow run URL, logs, and API response.
0.3 Never ask the user to guess. If something is unknown, inspect repo/code/logs and report what you found.
0.4 Never print secrets/tokens in logs. Redact always.
0.5 Any change must be additive and reversible. Create a git commit checkpoint for every step.
0.6 If a repo was deleted/recreated, detect it and re-apply required files/secrets safely.

1) CURRENT PROJECT CONTEXT (WHAT EXISTS NOW)
1.1 GitHub repo exists: mdislam7895121/ababil-platform
1.2 GitHub Actions workflow exists and runs successfully:
    - .github/workflows/mobile-publish.yml
    - Trigger: workflow_dispatch
    - Uses repository secrets:
      - API_BASE_URL
      - CI_CALLBACK_TOKEN
1.3 CI proof exists that the pipeline runs end-to-end:
    - Manual runs show GREEN success for workflow execution.
    - Callback mechanism is proven working (API receives CI callback and updates job).
1.4 Important constraint:
    - GitHub does NOT allow creating a secret named GITHUB_TOKEN (reserved). Do not use that name.
    - Use GH_TOKEN or GITHUB_PAT (secret names you control) if needed.
    - For Expo publishing: use EXPO_TOKEN (GitHub Actions secret).

2) WHAT IS COMPLETE (LOCKED)
2.1 CI Runner & Workflow Dispatch is working.
2.2 Secrets API_BASE_URL and CI_CALLBACK_TOKEN are configured and functional.
2.3 Workflow runs and can notify API status.

3) WHAT IS NOT COMPLETE (NEXT WORK)
3.1 Real mobile project is not integrated into the repo (no guaranteed apps/mobile Expo structure).
3.2 Real build steps (EAS build) are not finalized.
3.3 EXPO_TOKEN is not added yet.
3.4 Artifact upload/attach flow may be partial or missing depending on current backend.

4) TARGET ARCHITECTURE DECISION (DEFAULT)
Default decision: Expo (EAS) for mobile build/publish.
If the user later chooses Flutter, do NOT mix both; create a clean target split and update workflow accordingly.

5) REQUIRED ARCHITECTURE (OVERVIEW)
5.1 Single source of truth:
    - Backend/API triggers CI job
    - GitHub Actions executes build pipeline
    - GitHub Actions calls back to API with status + runUrl + runId
5.2 CI status model:
    - running → completed
    - conclusion: success|failure (from job.status)
5.3 Secrets:
    - API_BASE_URL (Replit deployment base URL)
    - CI_CALLBACK_TOKEN (shared secret for callback auth)
    - EXPO_TOKEN (Expo access token for EAS)
    - Optional: GH_TOKEN or GITHUB_PAT only if GitHub API calls are required (usually not needed for workflow_dispatch)

6) DEFINITION OF DONE (EACH STEP)
For any step, you must provide:
6.1 git status (clean)
6.2 git diff (shown)
6.3 commit hash + message
6.4 GitHub Actions run URL (if workflow involved)
6.5 Relevant logs snippet (no secrets)
6.6 API response proof (curl/Invoke-RestMethod)

7) TASK 1 (NEXT) — COLLECT CURRENT REPO FACTS (NO CHANGES)
Goal: Verify what exists right now, without editing.
Agent must do:
7.1 In GitHub repo:
    - Confirm .github/workflows/mobile-publish.yml exists on main
    - Confirm latest run is GREEN (provide run URL)
7.2 In Replit backend:
    - Find endpoints used by workflow callback:
      /api/mobile/publish/jobs/{jobId}/ci/callback
    - Confirm auth header required:
      X-CI-Token: CI_CALLBACK_TOKEN
7.3 Produce a short report:
    - Files present
    - Secrets expected
    - Current workflow steps
    - What is missing for real Expo build

Deliverable: “Current State Report” + proofs.

8) TASK 2 — ADD EXPO_TOKEN (NO CODE CHANGE)
Goal: Prepare for real Expo/EAS build.
Instructions:
8.1 Create Expo token (user action, agent explains):
    - Expo account → Access Tokens
    - Create token named “github-actions”
8.2 GitHub → Repo → Settings → Secrets and variables → Actions → New repository secret
    - Name: EXPO_TOKEN
    - Value: <token>
8.3 Proof required:
    - Screenshot-like textual confirmation: secret name exists (do not reveal value)
    - Optional: workflow log showing “eas-cli login --token” succeeds (no token printed)

Deliverable: “EXPO_TOKEN added” proof.

9) TASK 3 — UPGRADE WORKFLOW TO REAL EXPO BUILD (CONTROLLED)
Only after TASK 1–2 proofs.
9.1 Workflow must:
    - Checkout
    - Setup Node
    - cd to apps/mobile (if that’s the project location)
    - Install deps
    - Login EAS using EXPO_TOKEN
    - Run EAS build (or preview build) based on input target
9.2 Must keep existing callback steps intact and always execute final callback with runUrl/runId.
9.3 Must fail clearly if apps/mobile missing, with an explicit log message.

Deliverable: Updated workflow + GREEN run for “login” step proof.

10) IMPORTANT SAFETY NOTES
10.1 Never paste tokens into chat or commit.
10.2 Never write secrets into workflow logs.
10.3 If the user recreated/deleted repo, verify secrets and workflow are re-applied.

11) WHAT THE USER WANTS FROM YOU (AGENT)
11.1 Explain what is complete vs pending.
11.2 Maintain architecture consistency.
11.3 Make CI and publishing reliable without breaking completed foundation.
11.4 Provide proof for every claim.

START NOW:
- Perform TASK 1 (facts + proofs) only.
- Do not modify code yet.
- Return a “Current State Report” with concrete evidence and next action list.